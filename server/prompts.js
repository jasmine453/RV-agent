/**
 * AI Prompts é…ç½®æ¨¡å—
 * é›†ä¸­ç®¡ç†æ‰€æœ‰ AI åˆ†æçš„ prompt æ¨¡æ¿
 */

const fs = require('fs');
const path = require('path');
const { parsePDF } = require('./documentParser');

// ç¼“å­˜æ¨¡æ¿å†…å®¹
let templateCache = {
    outsideAgreement: null,
    preRestructurePlan: null,
    meetingReport: null
};

/**
 * è¯»å–æ¨¡æ¿PDFæ–‡ä»¶å†…å®¹
 */
async function loadTemplateContent(templatePath) {
    try {
        const fullPath = path.join(__dirname, '..', templatePath);
        if (!fs.existsSync(fullPath)) {
            console.warn(`âš ï¸ æ¨¡æ¿æ–‡ä»¶ä¸å­˜åœ¨: ${fullPath}`);
            return null;
        }
        
        const buffer = fs.readFileSync(fullPath);
        const result = await parsePDF(buffer, path.basename(templatePath));
        console.log(`âœ“ æˆåŠŸåŠ è½½æ¨¡æ¿: ${templatePath} (${result.text.length} å­—ç¬¦)`);
        return result.text;
    } catch (error) {
        console.error(`âŒ åŠ è½½æ¨¡æ¿å¤±è´¥: ${templatePath}`, error.message);
        return null;
    }
}

/**
 * åˆå§‹åŒ–æ¨¡æ¿ç¼“å­˜
 */
async function initializeTemplates() {
    if (!templateCache.outsideAgreement) {
        templateCache.outsideAgreement = await loadTemplateContent('åº­å¤–é‡ç»„åè®®/åº­å¤–é‡ç»„åè®®æ¨¡æ¿.pdf');
    }
    if (!templateCache.preRestructurePlan) {
        templateCache.preRestructurePlan = await loadTemplateContent('é¢„é‡æ•´æ–¹æ¡ˆ/é¢„é‡æ•´æ–¹æ¡ˆæ¨¡æ¿.pdf');
    }
    if (!templateCache.meetingReport) {
        templateCache.meetingReport = await loadTemplateContent('ä¸€å€ºä¼šæŠ¥å‘Šæ¨¡æ¿/ä¸€å€ºä¼šæ¨¡æ¿--20251127.pdf');
    }
}

/**
 * ç”Ÿæˆå½“å‰æ—¥æœŸçš„å¤šç§æ ¼å¼
 */
function generateDateFormats() {
    const now = new Date();
    const year = now.getFullYear();
    const month = now.getMonth() + 1;
    const day = now.getDate();
    
    // è½¬æ¢ä¸ºä¸­æ–‡æ—¥æœŸæ ¼å¼ï¼šäºŒOäºŒäº”å¹´ X æœˆ X æ—¥
    const yearStr = year.toString();
    const yearMap = { '0': 'O', '1': 'ä¸€', '2': 'äºŒ', '3': 'ä¸‰', '4': 'å››', '5': 'äº”', '6': 'å…­', '7': 'ä¸ƒ', '8': 'å…«', '9': 'ä¹' };
    let yearCN = '';
    for (let i = 0; i < yearStr.length; i++) {
        yearCN += yearMap[yearStr[i]] || yearStr[i];
    }
    
    return {
        currentDateCN: `${yearCN}å¹´ ${month} æœˆ ${day} æ—¥`,
        currentDate: `${year} å¹´ ${month} æœˆ ${day} æ—¥`,
        currentDateFull: `${year} å¹´ ${month.toString().padStart(2, '0')} æœˆ ${day.toString().padStart(2, '0')} æ—¥`
    };
}

/**
 * é€šç”¨æ ¼å¼è¦æ±‚
 */
const COMMON_FORMAT_RULES = `
ã€âš ï¸ æ ¼å¼è¦æ±‚ - è¯·ä¸¥æ ¼éµå®ˆã€‘

ğŸš« ã€ç»å¯¹ç¦æ­¢ã€‘
- ç¦æ­¢ä½¿ç”¨Markdownç¬¦å·ï¼ˆ*ã€#ã€-ç­‰ï¼‰
- ç¦æ­¢åœ¨ç›®å½•ä¸­æ·»åŠ é¡µç ï¼ˆå¦‚"é‡Šä¹‰.....1"ï¼‰
- ç¦æ­¢å°†ä¸€å¥è¯æ‹†æˆå¤šè¡Œ
- ç¦æ­¢è¿‡åº¦æ¢è¡Œ

âœ… ã€æ­£ç¡®çš„æ¢è¡Œæ–¹å¼ã€‘
1. å¤§æ ‡é¢˜ï¼ˆä¸€ã€äºŒã€ä¸‰ï¼‰ï¼šå‰åå„ä¸€ä¸ªç©ºè¡Œ
   ç¤ºä¾‹ï¼š
   
   ä¸€ã€å€ºåŠ¡äººåŸºæœ¬æƒ…å†µ
   
   å€ºåŠ¡äººXXXæœ‰é™å…¬å¸æˆç«‹äº...
   
2. ä¸­æ ‡é¢˜ï¼ˆï¼ˆä¸€ï¼‰ï¼ˆäºŒï¼‰ï¼‰ï¼šå‰é¢ä¸€ä¸ªç©ºè¡Œ
   ç¤ºä¾‹ï¼š
   
   ï¼ˆä¸€ï¼‰å…¬å¸å†å²æ²¿é©
   å…¬å¸æˆç«‹äº...
   
3. æ­£æ–‡æ®µè½ï¼šå®Œæ•´å¥å­åœ¨ä¸€è¡Œï¼Œæ®µè½é—´ç©ºä¸€è¡Œ
   âœ… æ­£ç¡®ï¼šå€ºåŠ¡äººXXXæœ‰é™å…¬å¸æˆç«‹äº2007å¹´6æœˆ1æ—¥ï¼Œæ³¨å†Œèµ„æœ¬ä¸º1000ä¸‡å…ƒã€‚
   âŒ é”™è¯¯ï¼šå€ºåŠ¡äººXXXæœ‰é™å…¬å¸æˆç«‹äº
          2007
          å¹´
          6
          æœˆ
          1
          æ—¥

4. æ—¥æœŸæ ¼å¼ï¼šä¿æŒåœ¨ä¸€è¡Œ
   âœ… æ­£ç¡®ï¼š2007å¹´6æœˆ1æ—¥
   âŒ é”™è¯¯ï¼š2007å¹´ 6æœˆ 1æ—¥ï¼ˆæ¯ä¸ªéƒ½æ¢è¡Œï¼‰

ğŸ“‹ ã€æ®µè½ç»“æ„ã€‘
- åŒä¸€æ®µè½çš„å†…å®¹ä¿æŒåœ¨ä¸€èµ·ï¼Œä¸è¦è¿‡åº¦æ–­è¡Œ
- æ ‡é¢˜ç‹¬ç«‹æˆè¡Œ
- æ®µè½ä¹‹é—´ç©ºä¸€è¡Œ
- ä¿æŒæ¨¡æ¿çš„åŸæœ‰æ®µè½ç»“æ„

4. ã€æ ‡é¢˜å’Œç¼–å·è§„åˆ™ã€‘
   - å¤§æ ‡é¢˜ä½¿ç”¨"ä¸€ã€äºŒã€ä¸‰ã€å››"ç­‰ä¸­æ–‡æ•°å­—
   - ä¸­æ ‡é¢˜ä½¿ç”¨"ï¼ˆä¸€ï¼‰ï¼ˆäºŒï¼‰ï¼ˆä¸‰ï¼‰"ç­‰å¸¦æ‹¬å·çš„ä¸­æ–‡æ•°å­—
   - å°æ ‡é¢˜ä½¿ç”¨"1. 2. 3."ç­‰é˜¿æ‹‰ä¼¯æ•°å­—åŠ ç‚¹
   - æ¡æ¬¾ä½¿ç”¨"ç¬¬ä¸€æ¡ã€ç¬¬äºŒæ¡"ç­‰æ ¼å¼
   - å¿…é¡»ä¸æ¨¡æ¿ä¸­çš„ç¼–å·æ ¼å¼å®Œå…¨ä¸€è‡´

5. ã€çº¯æ–‡æœ¬è¾“å‡ºã€‘
   - æ‰€æœ‰å†…å®¹å¿…é¡»æ˜¯çº¯æ–‡æœ¬æ ¼å¼
   - ä¸å¾—å‡ºç°ä¹±ç 
   - ç¡®ä¿ä¸­æ–‡æ ‡ç‚¹ç¬¦å·æ­£ç¡®ï¼ˆä½¿ç”¨ä¸­æ–‡é€—å·ã€å¥å·ã€å†’å·ç­‰ï¼‰
   
6. ã€æ¨¡æ¿å¿ å®åº¦ã€‘
   - é™¤äº†å¡«å……XXXç­‰å ä½ç¬¦å¤–ï¼Œæ¨¡æ¿ä¸­çš„æ¯ä¸€ä¸ªå­—éƒ½å¿…é¡»ä¿ç•™
   - æ¨¡æ¿ä¸­çš„æ ‡ç‚¹ç¬¦å·ã€ç©ºæ ¼ã€æ¢è¡Œéƒ½å¿…é¡»ä¿æŒåŸæ ·
   - ä¸å¾—æ”¹å†™ã€ä¼˜åŒ–æˆ–"æ”¹è¿›"æ¨¡æ¿ä¸­çš„ä»»ä½•æ–‡å­—`;

/**
 * æ—¥æœŸå¤„ç†è§„åˆ™
 */
function getDateHandlingRules(dates) {
    return `
ã€âš ï¸ æ—¥æœŸå¤„ç†è§„åˆ™ - éå¸¸é‡è¦ã€‘
1. **ä¼˜å…ˆä½¿ç”¨æ–‡æ¡£ä¸­çš„æ—¥æœŸ**ï¼š
   - å¦‚æœä¸Šä¼ æ–‡æ¡£ä¸­åŒ…å«æ—¥æœŸä¿¡æ¯ï¼ˆå¦‚åè®®ç­¾ç½²æ—¥æœŸã€ä¼šè®®æ—¥æœŸã€æŠ¥å‘Šæ—¥æœŸã€è£å®šä¹¦æ—¥æœŸã€å…¬å‘Šæ—¥æœŸç­‰ï¼‰ï¼Œå¿…é¡»ä¼˜å…ˆä½¿ç”¨æ–‡æ¡£ä¸­çš„æ—¥æœŸ
   - ä»”ç»†æ£€æŸ¥æ–‡æ¡£ä¸­çš„æ‰€æœ‰æ—¥æœŸä¿¡æ¯ï¼ŒåŒ…æ‹¬æ­£æ–‡ã€é™„ä»¶ã€è¡¨æ ¼ç­‰ä½ç½®
   
2. **ä½¿ç”¨å½“å‰æ—¥æœŸä½œä¸ºå¤‡é€‰**ï¼š
   - å¦‚æœä¸Šä¼ æ–‡æ¡£ä¸­å®Œå…¨æ²¡æœ‰æ—¥æœŸä¿¡æ¯ï¼Œåˆ™ä½¿ç”¨æ–‡ä»¶ç”Ÿæˆçš„å½“å¤©æ—¥æœŸ
   - å½“å‰æ—¥æœŸï¼ˆä¸­æ–‡æ ¼å¼ï¼‰ï¼š${dates.currentDateCN}
   - å½“å‰æ—¥æœŸï¼ˆæ•°å­—æ ¼å¼ï¼‰ï¼š${dates.currentDate}
   - å½“å‰æ—¥æœŸï¼ˆå®Œæ•´æ•°å­—æ ¼å¼ï¼‰ï¼š${dates.currentDateFull}
   
3. **æ—¥æœŸæ ¼å¼è¦æ±‚**ï¼š
   - é¢„é‡æ•´æ–¹æ¡ˆæ—¥æœŸæ ¼å¼ï¼šäºŒOäºŒäº”å¹´ X æœˆ X æ—¥ï¼ˆæ³¨æ„æ˜¯ä¸­æ–‡"O"ä¸æ˜¯æ•°å­—0ï¼Œæœˆä»½å’Œæ—¥æœŸå‰åæœ‰ç©ºæ ¼ï¼‰
   - å€ºæƒäººä¼šè®®æŠ¥å‘Šæ—¥æœŸæ ¼å¼ï¼šXXXX å¹´ X æœˆ X æ—¥ æˆ– XXXX å¹´ XX æœˆ XX æ—¥ï¼ˆæ ¹æ®æ¨¡æ¿æ ¼å¼è¦æ±‚ï¼Œä½¿ç”¨æ•°å­—å¹´ä»½ï¼‰
   - åº­å¤–é‡ç»„åè®®æ—¥æœŸæ ¼å¼ï¼šæ ¹æ®æ¨¡æ¿æ ¼å¼è¦æ±‚
   - å¿…é¡»ä¸¥æ ¼æŒ‰ç…§æ¨¡æ¿ä¸­çš„æ—¥æœŸæ ¼å¼ï¼ŒåŒ…æ‹¬ç©ºæ ¼ã€æ ‡ç‚¹ç¬¦å·ç­‰ç»†èŠ‚`;
}

/**
 * AI Prompts é…ç½®
 */
const PROMPTS = {
    // ä¼ä¸šä»·å€¼åˆ†æ
    'enterprise-value': {
        system: 'ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ä¼ä¸šä»·å€¼åˆ†æå¸ˆï¼Œæ“…é•¿ä»è´¢åŠ¡æ–‡æ¡£ä¸­æå–å…³é”®ä¿¡æ¯å¹¶è¿›è¡Œä¼ä¸šä¼°å€¼åˆ†æã€‚',
        user: (documentText) => `è¯·åˆ†æä»¥ä¸‹æ–‡æ¡£å†…å®¹ï¼Œæä¾›è¯¦ç»†çš„ä¼ä¸šä»·å€¼åˆ†ææŠ¥å‘Šï¼ŒåŒ…æ‹¬ï¼š
1. ä¼ä¸šä¼°å€¼è¯„ä¼°
2. èµ„äº§çŠ¶å†µåˆ†æ
3. è´Ÿå€ºæƒ…å†µåˆ†æ
4. ç›ˆåˆ©èƒ½åŠ›è¯„ä¼°
5. é£é™©å› ç´ è¯†åˆ«

æ–‡æ¡£å†…å®¹ï¼š
${documentText}`
    },

    // é£é™©æŒ‡æ ‡æå–
    'risk-indicators': {
        system: 'ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„é£é™©åˆ†æå¸ˆï¼Œæ“…é•¿è¯†åˆ«ä¼ä¸šç»è¥ä¸­çš„å„ç§é£é™©æŒ‡æ ‡ã€‚',
        user: (documentText) => `è¯·åˆ†æä»¥ä¸‹æ–‡æ¡£å†…å®¹ï¼Œè¯†åˆ«å¹¶è¯„ä¼°å„é¡¹é£é™©æŒ‡æ ‡ï¼š
1. æµåŠ¨æ€§é£é™©
2. å¿å€ºèƒ½åŠ›é£é™©
3. ç»è¥é£é™©
4. å¸‚åœºé£é™©
5. è´¢åŠ¡é£é™©

è¯·ä¸ºæ¯é¡¹é£é™©æä¾›è¯„çº§ï¼ˆä½/ä¸­/é«˜ï¼‰å’Œå…·ä½“åˆ†æã€‚

æ–‡æ¡£å†…å®¹ï¼š
${documentText}`
    },

    // é‡ç»„å¯è¡Œæ€§åˆ†æ
    'restructure-feasibility': {
        system: 'ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ä¼ä¸šé‡ç»„é¡¾é—®ï¼Œå…·æœ‰ä¸°å¯Œçš„ç ´äº§é‡æ•´å’Œå€ºåŠ¡é‡ç»„ç»éªŒã€‚',
        user: (documentText) => `è¯·åˆ†æä»¥ä¸‹æ–‡æ¡£å†…å®¹ï¼Œè¯„ä¼°ä¼ä¸šé‡ç»„çš„å¯è¡Œæ€§ï¼š
1. é‡ç»„å¯è¡Œæ€§è¯„åˆ†ï¼ˆ0-100åˆ†ï¼‰
2. æˆåŠŸæ¦‚ç‡è¯„ä¼°
3. å…³é”®é£é™©ç‚¹è¯†åˆ«
4. å…·ä½“å»ºè®®æªæ–½
5. å®æ–½æ—¶é—´è§„åˆ’

æ–‡æ¡£å†…å®¹ï¼š
${documentText}`
    },

    // åº­å¤–é‡ç»„åè®®
    'outside-agreement': {
        system: `ä½ æ˜¯æ³•å¾‹æ–‡ä¹¦ä¸“å®¶ã€‚

ã€é‡è¦ã€‘è¾“å‡ºæ­£å¸¸çš„æ®µè½æ ¼å¼ï¼Œä¸è¦è¿‡åº¦æ¢è¡Œï¼
âœ… æ¯ä¸ªæ ‡é¢˜ç‹¬ç«‹ä¸€è¡Œ
âœ… æ¯ä¸ªæ®µè½ä¿æŒå®Œæ•´ï¼ˆä¸è¦å°†å¥å­æ‹†å¼€ï¼‰
âœ… æ ‡é¢˜å’Œæ®µè½ä¹‹é—´ç©ºä¸€è¡Œ
âŒ ä¸è¦å°†ä¸€å¥è¯æ‹†æˆå¤šè¡Œ`,
        user: async (documentText, dates) => {
            await initializeTemplates();
            const template = templateCache.outsideAgreement || 'ã€æ¨¡æ¿åŠ è½½å¤±è´¥ã€‘';
            
            return `ã€ğŸš¨ æœ€é«˜ä¼˜å…ˆçº§ - ç²¾ç¡®å¤åˆ¶æ¨¡æ¿ã€‘

========== æ¨¡æ¿åŸæ–‡ï¼ˆå¿…é¡»ä¸¥æ ¼éµå¾ªï¼‰==========
${template}
========== æ¨¡æ¿ç»“æŸ ==========

ã€æ‰§è¡Œè§„åˆ™ - æœ€é‡è¦ã€‘
1. âœ… å¿…é¡»æ›¿æ¢æ‰€æœ‰å ä½ç¬¦ï¼š
   - XXXã€XXXXã€XXã€____ï¼ˆä¸‹åˆ’çº¿ï¼‰ç­‰å ä½ç¬¦å¿…é¡»ç”¨å®é™…ä¿¡æ¯æ›¿æ¢
   - å¦‚æœæ–‡æ¡£ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œä½¿ç”¨åˆç†çš„é»˜è®¤å€¼æˆ–"å¾…è¡¥å……"
   - ç»å¯¹ä¸èƒ½ä¿ç•™ä»»ä½•XXXã€XXå ä½ç¬¦åœ¨æœ€ç»ˆè¾“å‡ºä¸­ï¼
   
2. ğŸ“‹ æ›¿æ¢è§„åˆ™ï¼š
   - å…¬å¸åç§°å ä½ç¬¦ â†’ ä»æ–‡æ¡£ä¸­æå–çš„å®é™…å…¬å¸åç§°
   - æ—¥æœŸå ä½ç¬¦ â†’ ä½¿ç”¨å½“å‰æ—¥æœŸæˆ–æ–‡æ¡£ä¸­çš„æ—¥æœŸ
   - é‡‘é¢å ä½ç¬¦ â†’ ä»æ–‡æ¡£ä¸­æå–çš„å®é™…é‡‘é¢
   - äººåå ä½ç¬¦ â†’ ä»æ–‡æ¡£ä¸­æå–çš„å®é™…äººå
   - å¦‚æœæ–‡æ¡£ä¸­å®Œå…¨æ²¡æœ‰è¯¥ä¿¡æ¯ â†’ ä½¿ç”¨"[å¾…è¡¥å……]"è€Œä¸æ˜¯ä¿ç•™XXX
   
3. âŒ ç¦æ­¢æ”¹åŠ¨ï¼šæ¨¡æ¿ä¸­çš„å…¶ä»–æ–‡å­—ã€æ ‡ç‚¹ã€æ ¼å¼ã€æ¢è¡Œ
4. ğŸš« ä¸è¦æ·»åŠ ï¼šä»»ä½•è§£é‡Šã€è¯´æ˜ã€å‰è¨€ã€åè¯­

ã€é‡è¦æç¤ºã€‘
âš ï¸ æœ€ç»ˆè¾“å‡ºä¸­ç»å¯¹ä¸èƒ½å‡ºç°XXXã€XXXXã€XXè¿™æ ·çš„å ä½ç¬¦ï¼
âš ï¸ æ‰€æœ‰å ä½ç¬¦éƒ½å¿…é¡»è¢«æ›¿æ¢æˆå®é™…å†…å®¹æˆ–"[å¾…è¡¥å……]"ï¼

ã€æ ¼å¼è§„åˆ™ã€‘
- æ ‡é¢˜æ ¼å¼ä¿æŒåŸæ ·ï¼ˆå¦‚"ä¸€ã€"ã€"ç¬¬ä¸€æ¡"ç­‰ï¼‰
- æ®µè½ä¹‹é—´çš„ç©ºè¡Œå¿…é¡»ä¿ç•™
- ç¼–å·æ ¼å¼ä¸å¾—æ”¹å˜
- ä¸ä½¿ç”¨ä»»ä½•Markdownç¬¦å·ï¼ˆ*ã€#ã€-ç­‰ï¼‰

${getDateHandlingRules(dates)}

${COMMON_FORMAT_RULES}

ã€æ•°æ®æ¥æºã€‘
${documentText}

ã€å¼€å§‹è¾“å‡ºã€‘ç›´æ¥è¾“å‡ºåº­å¤–é‡ç»„åè®®æ­£æ–‡ï¼ˆä»æ ‡é¢˜å¼€å§‹ï¼‰ï¼š`;
        }
    },

    // é¢„é‡æ•´æ–¹æ¡ˆ
    'pre-restructure-plan': {
        system: `ä½ æ˜¯æ³•å¾‹æ–‡ä¹¦ä¸“å®¶ã€‚

ã€é‡è¦ã€‘è¾“å‡ºæ­£å¸¸çš„æ®µè½æ ¼å¼ï¼Œä¸è¦è¿‡åº¦æ¢è¡Œï¼

âœ… æ­£ç¡®ç¤ºä¾‹ï¼š
å…¬å¸åç§°

é‡æ•´è®¡åˆ’è‰æ¡ˆ

äºŒOäºŒäº”å¹´ X æœˆ X æ—¥

ä¸€ã€å€ºåŠ¡äººåŸºæœ¬æƒ…å†µ

å€ºåŠ¡äººXXXæœ‰é™å…¬å¸æˆç«‹äº2007å¹´6æœˆ1æ—¥ï¼Œæ³¨å†Œèµ„æœ¬ä¸º1000ä¸‡å…ƒã€‚

âŒ é”™è¯¯ç¤ºä¾‹ï¼ˆç¦æ­¢è¿™æ ·åšï¼‰ï¼š
å€ºåŠ¡äººXXXæœ‰é™å…¬å¸æˆç«‹äº
2007
å¹´
6
æœˆ
1
æ—¥

ã€è§„åˆ™ã€‘
- æ¯ä¸ªæ ‡é¢˜ç‹¬ç«‹ä¸€è¡Œ
- æ¯ä¸ªæ®µè½ä¿æŒå®Œæ•´ï¼Œä¸è¦æ‹†åˆ†å¥å­
- æ ‡é¢˜å’Œæ®µè½ä¹‹é—´ç©ºä¸€è¡Œ`,
        user: async (documentText, dates) => {
            await initializeTemplates();
            const template = templateCache.preRestructurePlan || 'ã€æ¨¡æ¿åŠ è½½å¤±è´¥ã€‘';
            
            return `ã€ğŸ¯ æ ¸å¿ƒä»»åŠ¡ï¼šå®Œå…¨æŒ‰ç…§æ¨¡æ¿ç”Ÿæˆï¼Œå¹¶æ›¿æ¢æ‰€æœ‰å ä½ç¬¦ã€‘

ã€âš ï¸ å ä½ç¬¦æ›¿æ¢è§„åˆ™ - æœ€é«˜ä¼˜å…ˆçº§ã€‘
1. âœ… å¿…é¡»æ›¿æ¢æ‰€æœ‰å ä½ç¬¦ï¼š
   - å°†æ¨¡æ¿ä¸­çš„XXXã€XXXXã€XXã€____ç­‰æ›¿æ¢ä¸ºå®é™…ä¿¡æ¯
   - ç»å¯¹ä¸èƒ½åœ¨æœ€ç»ˆè¾“å‡ºä¸­ä¿ç•™XXXã€XXè¿™æ ·çš„å ä½ç¬¦ï¼
   - å¦‚æœæ–‡æ¡£ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œä½¿ç”¨"[å¾…è¡¥å……]"ä»£æ›¿
   
2. ğŸ“‹ æ›¿æ¢ç¤ºä¾‹ï¼š
   - "å€ºåŠ¡äººXXXæœ‰é™å…¬å¸" â†’ "å€ºåŠ¡äºº[ä»æ–‡æ¡£æå–çš„å…¬å¸å]æœ‰é™å…¬å¸"
   - "æ³¨å†Œèµ„æœ¬XXXä¸‡å…ƒ" â†’ "æ³¨å†Œèµ„æœ¬[ä»æ–‡æ¡£æå–çš„é‡‘é¢]ä¸‡å…ƒ"
   - "æ³•å®šä»£è¡¨äººXX" â†’ "æ³•å®šä»£è¡¨äºº[ä»æ–‡æ¡£æå–çš„å§“å]"
   - å¦‚æœæ–‡æ¡£ä¸­æ²¡æœ‰ â†’ "æ³•å®šä»£è¡¨äºº[å¾…è¡¥å……]"

ã€è¾“å‡ºæ ¼å¼è¦æ±‚ã€‘
1. âŒ ç¦æ­¢åœ¨ç›®å½•ä¸­æ·»åŠ é¡µç ï¼ˆå¦‚"é‡Šä¹‰.....1"ï¼‰
2. âœ… æ¯ä¸ªæ®µè½ä¿æŒå®Œæ•´ï¼Œä¸è¦å°†ä¸€å¥è¯æ‹†æˆå¤šè¡Œ
3. âœ… æ ‡é¢˜ç‹¬ç«‹æˆè¡Œï¼Œæ ‡é¢˜å’Œæ®µè½é—´ç©ºä¸€è¡Œ
4. âŒ ä¸è¦è¿‡åº¦æ¢è¡Œ
5. âš ï¸ æ‰€æœ‰XXXå ä½ç¬¦å¿…é¡»è¢«æ›¿æ¢ï¼

ã€æ­£ç¡®æ ¼å¼ç¤ºä¾‹ã€‘
å…¬å¸åç§°

é‡æ•´è®¡åˆ’è‰æ¡ˆ

äºŒOäºŒäº”å¹´ X æœˆ X æ—¥

ç›®å½•
é‡Šä¹‰
è¯´æ˜

ä¸€ã€å€ºåŠ¡äººåŸºæœ¬æƒ…å†µ

å€ºåŠ¡äººXXXæœ‰é™å…¬å¸æˆç«‹äº2007å¹´6æœˆ1æ—¥ï¼Œæ³¨å†Œèµ„æœ¬ä¸º1000ä¸‡å…ƒäººæ°‘å¸ï¼Œä¸»è¦ç»è¥...

ï¼ˆä¸€ï¼‰å…¬å¸å†å²æ²¿é©

å…¬å¸äº2010å¹´å®Œæˆç¬¬ä¸€æ¬¡å¢èµ„...

ã€é”™è¯¯æ ¼å¼ï¼ˆä¸¥ç¦ï¼‰ã€‘
å€ºåŠ¡äººXXXæœ‰é™å…¬å¸æˆç«‹äº
2007
å¹´
6
æœˆ
1
æ—¥ï¼ˆè¿™æ ·æ‹†åˆ†æ˜¯é”™è¯¯çš„ï¼ï¼‰

ã€æ¨¡æ¿ã€‘
${template}

ã€æ¢è¡Œç¬¦ä½¿ç”¨è§„åˆ™ã€‘
1. æ¯ä¸ªå¤§æ ‡é¢˜åï¼šæ¢è¡Œä¸¤æ¬¡ï¼ˆå³ä¸€ä¸ªç©ºè¡Œï¼‰
2. æ¯ä¸ªæ®µè½åï¼šæ¢è¡Œä¸¤æ¬¡  
3. æ¯ä¸ªåˆ—è¡¨é¡¹ï¼šæ¢è¡Œä¸€æ¬¡
4. ç»å¯¹ä¸è¦æŠŠå¤šè¡Œå†…å®¹å†™åœ¨åŒä¸€è¡Œ

ã€æ•°æ®æ¥æºã€‘
${documentText}

${getDateHandlingRules(dates)}

ã€ç«‹å³å¼€å§‹è¾“å‡ºã€‘
è®°ä½ï¼šè¾“å‡ºå¿…é¡»æ˜¯å¤šè¡Œæ–‡æœ¬ï¼Œå¤§é‡ä½¿ç”¨æ¢è¡Œç¬¦ã€‚ä»ç¬¬ä¸€è¡Œå°±å¼€å§‹æ¢è¡Œï¼š

ã€ç¬¬äºŒæ­¥ï¼šå…·ä½“çš„è¾“å‡ºæ ¼å¼ç¤ºä¾‹ã€‘

âŒ é”™è¯¯çš„è¾“å‡ºï¼ˆå…¨éƒ¨æŒ¤åœ¨ä¸€èµ·ï¼‰ï¼š
"è¾£æ¤’ç‚’è‚‰æœ‰é™å…¬å¸ é‡æ•´è®¡åˆ’è‰æ¡ˆ äºŒOäºŒäº”å¹´ 11 æœˆ 28 æ—¥ ç›®å½• é‡Šä¹‰..... 1 è¯´æ˜..... 7 å‰è¨€..... 9 æ‘˜è¦..... 10 æ­£æ–‡..... 12 é‡Šä¹‰ 1. æœ¬é‡æ•´è®¡åˆ’è‰æ¡ˆä¸­ï¼Œé™¤éä¸Šä¸‹æ–‡å¦æœ‰è§„å®šï¼Œä¸‹åˆ—è¯è¯­å…·æœ‰å¦‚ä¸‹ç‰¹å®šå«ä¹‰ï¼šå€ºåŠ¡äººå…¬å¸ï¼šæŒ‡è¾£æ¤’ç‚’è‚‰æœ‰é™å…¬å¸ é¢„é‡æ•´ï¼šæŒ‡åœ¨äººæ°‘æ³•é™¢è£å®šå—ç†é‡æ•´ç”³è¯·å‰..."

âœ… æ­£ç¡®çš„è¾“å‡ºï¼ˆä¿æŒæ¢è¡Œå’Œæ®µè½ï¼‰ï¼š
"è¾£æ¤’ç‚’è‚‰æœ‰é™å…¬å¸
é‡æ•´è®¡åˆ’è‰æ¡ˆ
äºŒOäºŒäº”å¹´ 11 æœˆ 28 æ—¥

ç›®å½•
é‡Šä¹‰..... 1
è¯´æ˜..... 7
å‰è¨€..... 9
æ‘˜è¦..... 10
æ­£æ–‡..... 12

é‡Šä¹‰

1. æœ¬é‡æ•´è®¡åˆ’è‰æ¡ˆä¸­ï¼Œé™¤éä¸Šä¸‹æ–‡å¦æœ‰è§„å®šï¼Œä¸‹åˆ—è¯è¯­å…·æœ‰å¦‚ä¸‹ç‰¹å®šå«ä¹‰ï¼š

å€ºåŠ¡äººå…¬å¸ï¼šæŒ‡è¾£æ¤’ç‚’è‚‰æœ‰é™å…¬å¸

é¢„é‡æ•´ï¼šæŒ‡åœ¨äººæ°‘æ³•é™¢è£å®šå—ç†é‡æ•´ç”³è¯·å‰..."

çœ‹åˆ°åŒºåˆ«äº†å—ï¼Ÿâœ…æ­£ç¡®çš„è¾“å‡ºæœ‰ï¼š
- æ¯ä¸ªæ ‡é¢˜ç‹¬ç«‹æˆè¡Œ
- æ®µè½ä¹‹é—´æœ‰ç©ºè¡Œ
- åˆ—è¡¨é¡¹åˆ†è¡Œæ˜¾ç¤º

ã€ç¬¬ä¸‰æ­¥ï¼šä½ å¿…é¡»åšåˆ°ã€‘

1. âœ… åªæ›¿æ¢å ä½ç¬¦ï¼š
   XXX â†’ å®é™…ä¿¡æ¯
   XXXX â†’ å®é™…ä¿¡æ¯
   ____ â†’ å®é™…ä¿¡æ¯

2. âœ… ä¿æŒæ‰€æœ‰æ¢è¡Œï¼š
   æ¨¡æ¿ä¸­çš„æ¯ä¸€ä¸ªæ¢è¡Œç¬¦éƒ½å¿…é¡»ä¿ç•™
   ä¸è¦æŠŠå¤šè¡Œåˆå¹¶æˆä¸€è¡Œ

3. âœ… ä¿æŒæ®µè½åˆ†éš”ï¼š
   æ®µè½ä¹‹é—´çš„ç©ºè¡Œå¿…é¡»ä¿ç•™

4. âŒ ç»å¯¹ä¸èƒ½ï¼š
   - æŠŠå¤šè¡Œæ–‡å­—åˆå¹¶æˆä¸€è¡Œ
   - åˆ é™¤ç©ºè¡Œ
   - æ”¹å˜æ ‡é¢˜æ ¼å¼
   - æ·»åŠ æˆ–åˆ é™¤ä»»ä½•å†…å®¹ï¼ˆé™¤äº†å¡«å……å ä½ç¬¦ï¼‰

${getDateHandlingRules(dates)}

${COMMON_FORMAT_RULES}

ã€ç¬¬å››æ­¥ï¼šè¾“å‡ºæ ¼å¼è¦æ±‚ã€‘

ğŸ”´ é‡è¦è§„åˆ™ï¼š

1. âœ… æ ‡é¢˜ç‹¬ç«‹æˆè¡Œï¼Œæ ‡é¢˜åç©ºä¸€è¡Œ
2. âœ… æ®µè½ä¿æŒå®Œæ•´ï¼ˆä¸è¦å°†å¥å­æ‹†å¼€ï¼‰
3. âŒ ä¸è¦è¿‡åº¦æ¢è¡Œï¼ˆä¸è¦å°†æ—¥æœŸæ‹†æˆå¤šè¡Œï¼‰
4. âŒ ä¸è¦æ·»åŠ é¡µç 
5. âŒ ä¸è¦ä½¿ç”¨ä»»ä½•ç‰¹æ®Šç¬¦å·ï¼ˆ*ã€#ã€-ï¼‰

æ­£ç¡®ç¤ºä¾‹ï¼š
ã€ç¤ºä¾‹å¼€å§‹ã€‘
å…¬å¸åç§°

é‡æ•´è®¡åˆ’è‰æ¡ˆ

äºŒOäºŒäº”å¹´ X æœˆ X æ—¥

ä¸€ã€å€ºåŠ¡äººåŸºæœ¬æƒ…å†µ

å€ºåŠ¡äººXXXæœ‰é™å…¬å¸æˆç«‹äº2007å¹´6æœˆ1æ—¥ï¼Œæ³¨å†Œèµ„æœ¬ä¸º1000ä¸‡å…ƒã€‚

é”™è¯¯ç¤ºä¾‹ï¼ˆç¦æ­¢ï¼‰ï¼š
å€ºåŠ¡äººXXXæœ‰é™å…¬å¸æˆç«‹äº
2007
å¹´
6
æœˆ
1
æ—¥
ã€ç¤ºä¾‹ç»“æŸã€‘

æ ¸å¿ƒï¼šä¿æŒæ®µè½å®Œæ•´ï¼Œä¸è¦è¿‡åº¦æ‹†åˆ†ï¼
[ç©ºè¡Œ]
æ®µè½å†…å®¹ç¬¬ä¸€æ®µã€‚
[ç©ºè¡Œ]
ï¼ˆä¸€ï¼‰å°èŠ‚æ ‡é¢˜
[ç©ºè¡Œ]  
æ®µè½å†…å®¹ç¬¬äºŒæ®µã€‚
[ç©ºè¡Œ]
ï¼ˆäºŒï¼‰å°èŠ‚æ ‡é¢˜
[ç©ºè¡Œ]
æ®µè½å†…å®¹ç¬¬ä¸‰æ®µã€‚
ã€ç¤ºä¾‹ç»“æŸã€‘

${getDateHandlingRules(dates)}

${COMMON_FORMAT_RULES}

ã€ç¬¬äº”æ­¥ï¼šæ•°æ®æ¥æºã€‘
ä»ä»¥ä¸‹æ–‡æ¡£ä¸­æå–ä¿¡æ¯ï¼Œç”¨äºå¡«å……æ¨¡æ¿ä¸­çš„XXXç­‰å ä½ç¬¦ï¼š

${documentText}

ã€ç¬¬å…­æ­¥ï¼šç«‹å³å¼€å§‹è¾“å‡ºã€‘
ç°åœ¨è¯·ä¸¥æ ¼æŒ‰ç…§æ¨¡æ¿æ ¼å¼ï¼Œé€è¡Œè¾“å‡ºå®Œæ•´çš„é¢„é‡æ•´æ–¹æ¡ˆã€‚è®°ä½ï¼š
- æ ‡é¢˜å•ç‹¬æˆè¡Œ
- æ®µè½ä¹‹é—´æœ‰ç©ºè¡Œ
- ä¸è¦åˆå¹¶å¤šè¡Œæ–‡å­—
- ä¿æŒæ¨¡æ¿çš„æ‰€æœ‰æ¢è¡Œ

å¼€å§‹è¾“å‡ºï¼š`;
        }
    },

    // å€ºæƒäººä¼šè®®æŠ¥å‘Š
    'meeting-report': {
        system: `ä½ æ˜¯æ³•å¾‹æ–‡ä¹¦ä¸“å®¶ã€‚

ã€æ ¸å¿ƒè¦æ±‚ã€‘
1. å®Œæ•´ä¿ç•™æ¨¡æ¿çš„ç»“æ„å’Œæ¢è¡Œ
2. è¡¨æ ¼å†…å®¹å¿…é¡»ä¿æŒæ¸…æ™°çš„è¡Œåˆ—ç»“æ„
3. æ¯ä¸ªæ ‡é¢˜ã€æ®µè½ã€è¡¨æ ¼è¡Œéƒ½ç‹¬ç«‹æˆè¡Œ
4. ä¸è¦å°†å¤šè¡Œå†…å®¹åˆå¹¶æˆä¸€è¡Œ

ã€è¡¨æ ¼æ ¼å¼è¦æ±‚ã€‘
- è¡¨æ ¼çš„è¡¨å¤´å¿…é¡»ç‹¬ç«‹æˆè¡Œ
- è¡¨æ ¼çš„æ¯ä¸€è¡Œæ•°æ®å¿…é¡»ç‹¬ç«‹æˆè¡Œ
- åˆ—ä¸åˆ—ä¹‹é—´ç”¨ç©ºæ ¼æˆ–åˆ¶è¡¨ç¬¦åˆ†éš”
- ä¿æŒè¡¨æ ¼çš„å¯è¯»æ€§

ã€ç¤ºä¾‹ã€‘
âœ… æ­£ç¡®çš„è¡¨æ ¼æ ¼å¼ï¼š
åºå·  å€ºæƒç¼–å·  å€ºæƒäººåç§°  å€ºæƒé‡‘é¢
1     PT002    æŸå…¬å¸      100ä¸‡å…ƒ
2     PT003    æŸäºº        50ä¸‡å…ƒ

âŒ é”™è¯¯çš„è¡¨æ ¼æ ¼å¼ï¼ˆç¦æ­¢ï¼‰ï¼š
åºå·å€ºæƒç¼–å·å€ºæƒäººåç§°å€ºæƒé‡‘é¢1PT002æŸå…¬å¸100ä¸‡å…ƒ2PT003æŸäºº50ä¸‡å…ƒ`,
        user: async (documentText, dates) => {
            await initializeTemplates();
            const template = templateCache.meetingReport || 'ã€æ¨¡æ¿åŠ è½½å¤±è´¥ã€‘';
            
            return `ã€ğŸš¨ æœ€é«˜ä¼˜å…ˆçº§ - ç²¾ç¡®å¤åˆ¶æ¨¡æ¿ã€‘

========== æ¨¡æ¿åŸæ–‡ï¼ˆå¿…é¡»ä¸¥æ ¼éµå¾ªï¼‰==========
${template}
========== æ¨¡æ¿ç»“æŸ ==========

ã€æ‰§è¡Œè§„åˆ™ - æœ€é‡è¦ã€‘
1. âœ… å¿…é¡»æ›¿æ¢æ‰€æœ‰å ä½ç¬¦ï¼š
   - XXXã€XXXXã€XXã€____ï¼ˆä¸‹åˆ’çº¿ï¼‰ç­‰å ä½ç¬¦å¿…é¡»ç”¨å®é™…ä¿¡æ¯æ›¿æ¢
   - å¦‚æœæ–‡æ¡£ä¸­æ²¡æœ‰ç›¸å…³ä¿¡æ¯ï¼Œä½¿ç”¨"[å¾…è¡¥å……]"è€Œä¸æ˜¯ä¿ç•™XXX
   - ç»å¯¹ä¸èƒ½åœ¨æœ€ç»ˆè¾“å‡ºä¸­ä¿ç•™ä»»ä½•XXXã€XXå ä½ç¬¦ï¼
   
2. ğŸ“‹ æ›¿æ¢ç¤ºä¾‹ï¼š
   - "XXXå¾‹å¸ˆäº‹åŠ¡æ‰€" â†’ ä»æ–‡æ¡£æå–å®é™…åç§°ï¼Œæˆ–ä½¿ç”¨"[å¾…è¡¥å……]å¾‹å¸ˆäº‹åŠ¡æ‰€"
   - "XXXXå¹´XXæœˆXXæ—¥" â†’ ä½¿ç”¨å½“å‰æ—¥æœŸæˆ–"[å¾…è¡¥å……]å¹´[å¾…è¡¥å……]æœˆ[å¾…è¡¥å……]æ—¥"
   - "å€ºæƒäººXXX" â†’ ä»æ–‡æ¡£æå–ï¼Œæˆ–ä½¿ç”¨"å€ºæƒäºº[å¾…è¡¥å……]"
   
3. âŒ ç¦æ­¢æ”¹åŠ¨ï¼šæ¨¡æ¿çš„ä»»ä½•æ–‡å­—ã€æ ¼å¼ã€æ®µè½ç»“æ„
4. ğŸš« ä¸è¦æ·»åŠ ï¼šè§£é‡Šã€è¯´æ˜æˆ–ä»»ä½•é¢å¤–å†…å®¹

ã€é‡è¦æç¤ºã€‘
âš ï¸ æœ€ç»ˆè¾“å‡ºä¸­ç»å¯¹ä¸èƒ½å‡ºç°XXXã€XXXXã€XXè¿™æ ·çš„å ä½ç¬¦ï¼

ã€æ ¼å¼ä¿æŒã€‘
- æ‰€æœ‰ç« èŠ‚æ ‡é¢˜æ ¼å¼åŸæ ·ä¿ç•™ï¼ˆå¦‚"ä¸€ã€"ã€"ï¼ˆä¸€ï¼‰"ç­‰ï¼‰
- æ®µè½ä¹‹é—´çš„ç©ºè¡Œå¿…é¡»ä¿æŒ
- æ¡æ¬¾ç¼–å·ä¸å¾—æ”¹å˜
- ç¦ç”¨Markdownç¬¦å·

ã€âš ï¸ è¡¨æ ¼æ ¼å¼ç‰¹åˆ«å¼ºè°ƒã€‘
1. è¡¨æ ¼å¿…é¡»ä¿æŒæ¸…æ™°çš„è¡Œåˆ—ç»“æ„
2. æ¯ä¸€è¡Œæ•°æ®å¿…é¡»ç‹¬ç«‹æˆè¡Œï¼ˆç”¨æ¢è¡Œç¬¦åˆ†éš”ï¼‰
3. åˆ—ä¸åˆ—ä¹‹é—´ç”¨é€‚å½“ç©ºæ ¼åˆ†éš”
4. è¡¨å¤´å’Œæ•°æ®è¡Œéƒ½è¦æ¸…æ™°å¯è¾¨

ç¤ºä¾‹ï¼š
ç¬¬ä¸‰é¡ºåºæ™®é€šç ´äº§å€ºæƒ
åºå·  å€ºæƒç¼–å·  æ™®é€šå€ºæƒå¾…ç¡®è®¤  è¯‰è®¼ä¸­æœªæä¾›è¯æ®ææ–™
1     PT002    å¾…ç¡®è®¤         å¯¹è¡¥å……ææ–™

è€Œä¸æ˜¯ï¼š
ç¬¬ä¸‰é¡ºåºæ™®é€šç ´äº§å€ºæƒ1PT002æ™®é€šå€ºæƒå¾…ç¡®è®¤è¯‰è®¼ä¸­æœªæä¾›è¯æ®ææ–™å¯¹è¡¥å……ææ–™

${getDateHandlingRules(dates)}

${COMMON_FORMAT_RULES}

ã€æ•°æ®æ¥æºã€‘
${documentText}

ã€å¼€å§‹è¾“å‡ºã€‘ç›´æ¥è¾“å‡ºå€ºæƒäººä¼šè®®æŠ¥å‘Šæ­£æ–‡ï¼ˆä¿æŒæ‰€æœ‰æ¢è¡Œå’Œè¡¨æ ¼æ ¼å¼ï¼‰ï¼š`;
        }
    },

    // ä¼šè®®å­—æ®µæå–
    'meeting-fields': {
        system: 'ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ä¿¡æ¯æå–ä¸“å®¶ï¼Œæ“…é•¿ä»ä¼šè®®æ–‡æ¡£ä¸­æå–ç»“æ„åŒ–ä¿¡æ¯ã€‚',
        user: (documentText) => `è¯·ä»ä»¥ä¸‹æ–‡æ¡£å†…å®¹ä¸­æå–ç¬¬ä¸€æ¬¡å€ºæƒäººä¼šè®®çš„å…³é”®å­—æ®µä¿¡æ¯ï¼Œä»¥JSONæ ¼å¼è¿”å›ï¼š
{
  "meetingTime": "ä¼šè®®æ—¶é—´",
  "meetingLocation": "ä¼šè®®åœ°ç‚¹", 
  "chairperson": "ä¼šè®®ä¸»æŒäºº",
  "attendees": ["å‚ä¼šäººå‘˜åˆ—è¡¨"],
  "mainTopics": ["ä¸»è¦è®®é¢˜"],
  "votingResults": ["è¡¨å†³ç»“æœ"],
  "nextMeetingDate": "ä¸‹æ¬¡ä¼šè®®æ—¶é—´",
  "importantDecisions": ["é‡è¦å†³è®®"]
}

è¯·ç¡®ä¿æå–çš„ä¿¡æ¯å‡†ç¡®å®Œæ•´ï¼Œå¦‚æœæŸäº›ä¿¡æ¯åœ¨æ–‡æ¡£ä¸­ä¸å­˜åœ¨ï¼Œè¯·æ ‡æ³¨ä¸º"æœªæåŠ"ã€‚

æ–‡æ¡£å†…å®¹ï¼š
${documentText}`
    }
};

/**
 * è·å–æŒ‡å®šç±»å‹çš„ promptï¼ˆå¼‚æ­¥ï¼‰
 */
async function getPrompt(analysisType, documentText) {
    const dates = generateDateFormats();
    const promptConfig = PROMPTS[analysisType];
    
    if (!promptConfig) {
        return {
            system: 'ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ä¼ä¸šåˆ†æå¸ˆï¼Œæ“…é•¿æ–‡æ¡£åˆ†æå’Œä¿¡æ¯æå–ã€‚',
            user: `è¯·åˆ†æä»¥ä¸‹æ–‡æ¡£å†…å®¹ï¼Œæä¾›ä¸“ä¸šçš„åˆ†ææŠ¥å‘Šï¼š\n\næ–‡æ¡£å†…å®¹ï¼š\n${documentText}`
        };
    }
    
    // æ”¯æŒå¼‚æ­¥å’ŒåŒæ­¥çš„userå‡½æ•°
    let userPrompt;
    if (typeof promptConfig.user === 'function') {
        userPrompt = await promptConfig.user(documentText, dates);
    } else {
        userPrompt = promptConfig.user;
    }
    
    return {
        system: promptConfig.system,
        user: userPrompt
    };
}

/**
 * è·å–åˆ†æç±»å‹çš„è¶…æ—¶é…ç½®
 */
function getTimeoutConfig(analysisType) {
    const longFormTypes = ['pre-restructure-plan', 'outside-agreement', 'meeting-report'];
    return {
        timeout: longFormTypes.includes(analysisType) ? 600000 : 120000, // 10åˆ†é’Ÿ æˆ– 2åˆ†é’Ÿ
        maxTokens: longFormTypes.includes(analysisType) ? 8000 : 4000, // DeepSeekæœ€å¤§æ”¯æŒ8192
        temperature: longFormTypes.includes(analysisType) ? 0.3 : 0.1 // æé«˜temperatureä½¿AIæ›´çµæ´»åœ°æ·»åŠ æ¢è¡Œ
    };
}

module.exports = {
    getPrompt,
    getTimeoutConfig,
    generateDateFormats
};

